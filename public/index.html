<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Détection et Transcription Vocale avec IA</title>
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- ONNX Runtime et VAD scripts -->
    <script src="https://cdn.jsdelivr.net/npm/onnxruntime-web@1.14.0/dist/ort.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@ricky0123/vad-web@0.0.22/dist/bundle.min.js"></script>
    <!-- Modules JavaScript -->
    
    <script type="module" src="/js/main.js"></script>
    <link rel="stylesheet" href="/css/main.css">
    <!-- slider js -->
     <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/swiper@9/swiper-bundle.min.css" />
     <script src="https://cdn.jsdelivr.net/npm/swiper@9/swiper-bundle.min.js"></script>
</head>
<body class="bg-gray-100 p-4 flex flex-col min-h-screen">
    <!-- Bouton pour ouvrir le menu -->
    <button id="drawer-toggle" class="fixed top-4 left-4 z-50 bg-gray-800 text-white px-3 py-2 rounded-md shadow-md">
        ☰ Menu
    </button>
    
    <!-- Menu latéral -->
    <div id="drawer" class="fixed top-0 left-0 h-full w-64 bg-white shadow-lg transform -translate-x-full transition-transform duration-300 z-40">
        <div class="p-4 border-b font-bold text-lg">Menu</div>
        <div class="p-4 space-y-4">
            <div class="mt-6">
                <label for="api-key" class="block text-sm font-medium text-gray-700 mb-1">Clé API Groq:</label>
                <input type="password" id="api-key" class="w-full p-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-300" placeholder="Entrez votre clé API Groq ici">
                <p class="text-xs text-gray-500 mt-1">La clé sera sauvegardée localement pour faciliter son utilisation.</p>
            </div>
            <div id="audio-segments" class="mb-4">
                <h3 class="font-medium mb-2">Segments audio: <span id="segments-count">0</span></h3>
                <div id="segments-list" class="max-h-32 overflow-y-auto bg-gray-100 p-2 rounded-md text-sm"></div>
            </div>

            <button class="w-full text-left px-4 py-2 bg-green-100 rounded-md hover:bg-green-200">Réinitialiser</button>
            <button class="w-full text-left px-4 py-2 bg-red-100 rounded-md hover:bg-red-200">Historique</button>
        </div>
    </div>

    <!-- Contenu principal -->
    <div class="container mx-auto max-w-lg flex-grow mb-24">
        <h1 class="text-2xl font-bold mb-6 text-center">Assistant Vocal Intelligent</h1>
        
        <!-- Zone de conversation avec design amélioré -->
        <div class="bg-white p-6 rounded-xl shadow-md">
            <div class="mt-4">
                <h3 class="font-bold text-lg mb-2">Conversation</h3>
                <div id="conversation-list" class="max-h-80 overflow-y-auto bg-gray-100 p-3 rounded-md">
                    <!-- Messages du chat avec design amélioré -->
                    <div class="message user mb-3">
                        <div class="bg-blue-100 p-3 rounded-lg inline-block max-w-[80%] ml-auto mr-0 text-right">
                            <p class="text-gray-800">Exemple de message utilisateur</p>
                            <span class="text-xs text-gray-500 block mt-1">14:22</span>
                        </div>
                    </div>
                    <div class="message assistant mb-3">
                        <div class="bg-gray-200 p-3 rounded-lg inline-block max-w-[80%]">
                            <p class="text-gray-800">Exemple de réponse de l'assistant</p>
                            <span class="text-xs text-gray-500 block mt-1">14:23</span>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Slider fixé en bas -->
    <div class="fixed bottom-0 left-0 right-0 bg-white shadow-lg z-30">
        <div class="container mx-auto max-w-lg">
            <div class="swiper-container p-4">
                <div class="swiper-wrapper">
                    <!-- Premier slide avec les contrôles de l'assistant vocal -->
                    <div class="swiper-slide p-4 text-center">
                        <div class="mb-4 text-center">
                            <div id="status-indicator" class="w-16 h-16 rounded-full mx-auto flex items-center justify-center bg-gray-300 transition-colors duration-300">
                                <svg xmlns="http://www.w3.org/2000/svg" class="h-8 w-8 text-white" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 11a7 7 0 01-7 7m0 0a7 7 0 01-7-7m7 7v4m0 0H8m4 0h4m-4-8a3 3 0 01-3-3V5a3 3 0 116 0v6a3 3 0 01-3 3z" />
                                </svg>
                            </div>
                            <p id="status-text" class="mt-2 font-medium">En attente de démarrer</p>
                        </div>
                        
                        <div class="flex justify-center space-x-4">
                            <button id="start-button" class="px-4 py-2 rounded-md bg-blue-500 text-white hover:bg-blue-600 transition-colors focus:outline-none focus:ring-2 focus:ring-blue-300">
                                Démarrer
                            </button>
                            <button id="stop-button" class="px-4 py-2 rounded-md bg-gray-300 text-gray-500 cursor-not-allowed transition-colors" disabled>
                                Arrêter
                            </button>
                            <button id="mute-button" class="px-4 py-2 rounded-md bg-yellow-500 text-white hover:bg-yellow-600 transition-colors focus:outline-none focus:ring-2 focus:ring-yellow-300 cursor-not-allowed" disabled>
                                Couper Micro
                            </button>
                        </div>
                    </div>
                    
                    <!-- Deuxième slide avec input texte -->
                    <div class="swiper-slide p-4 text-center">
                        <form id="text-input-form" class="flex space-x-2">
                            <input type="text" id="text-input" placeholder="Ou tapez votre message ici..." 
                                   class="flex-grow px-4 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-300">
                            <button type="submit" id="send-text-button" class="px-4 py-2 rounded-md bg-green-500 text-white hover:bg-green-600 transition-colors focus:outline-none focus:ring-2 focus:ring-green-300">
                                Envoyer
                            </button>
                        </form>
                    </div>
                    
                    <!-- Troisième slide -->
                    <div class="swiper-slide p-4 text-center">
                      <button id="record-button" class="px-4 py-2 rounded-md bg-purple-500 text-white hover:bg-purple-600 transition-colors focus:outline-none focus:ring-2 focus:ring-purple-300">
    Enregistrer
</button>
<button id="stop-record-button" class="px-4 py-2 rounded-md bg-gray-300 text-gray-500 cursor-not-allowed transition-colors" disabled>
    Arrêter l'enregistrement
</button>
                    </div>
                </div>
                <!-- Pagination -->
                <div class="swiper-pagination"></div>
            </div>
        </div>
    </div>
    
    <!-- Lecteur audio caché -->
    <audio id="tts-player" style="display:none;" controls></audio>

    <script>
        // Script pour le menu latéral
        const drawer = document.getElementById("drawer");
        const toggleBtn = document.getElementById("drawer-toggle");

        toggleBtn.addEventListener("click", () => {
            drawer.classList.toggle("-translate-x-full");
        });

        // Initialisation du Swiper
        document.addEventListener('DOMContentLoaded', function() {
            const swiper = new Swiper('.swiper-container', {
                pagination: {
                    el: '.swiper-pagination',
                    clickable: true,
                },
                loop: false,
                slidesPerView: 1,
            });
        });
    </script>
</body>
</html>